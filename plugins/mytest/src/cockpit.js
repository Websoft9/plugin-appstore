(()=>{"use strict";let e;try{e=window.localStorage.getItem("url-root")}catch(e){}!function(){const n={};if(E(n,{}),void 0===window.debugging)try{Object.defineProperty(window,"debugging",{get:function(){return window.sessionStorage.debugging||window.localStorage.debugging},set:function(e){window.sessionStorage.debugging=e}})}catch(e){}function t(e){return"function"==typeof e}function o(e){return null!==e&&"object"==typeof e}function i(e){return o(e)&&"[object Object]"===Object.prototype.toString.call(e)}function r(e){return((e=+e)||1/e)<0}function s(e,n,t){const o=e?e.length:0;for(let i=0;i<o;i++)e[i]&&e[i].apply(n,t)}function c(e,n,t){let o=!1,i=0;t||(t=65536),e&&(e.byteLength?(i=e.byteLength,o=!0):e.length&&(i=e.length));for(let r=0;r<i;r+=t){const s=Math.min(i-r,t);n(o?new window.Uint8Array(e.buffer,r,s):e.substr(r,s))}}let l=null,a=null,u=!1,d=!1,f=null,p=null,h=null,g=null,m=null,w=window.location.origin;function v(e,n){const t=e.length,o=new(n||Array)(t);for(let n=0;n<t;n++)o[n]=255&e.charCodeAt(n);return o}function b(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65}function y(e){if("string"==typeof e)return window.btoa(e);e instanceof window.ArrayBuffer&&(e=new window.Uint8Array(e));const n=e.length;let t=2,o="";for(let i=0,r=0;r<n;r++)t=r%3,i|=e[r]<<(16>>>t&24),2!==t&&n-r!=1||(o+=String.fromCharCode(b(i>>>18&63),b(i>>>12&63),b(i>>>6&63),b(63&i)),i=0);return o.substr(0,o.length-2+t)+(2===t?"":1===t?"=":"==")}function k(e,n){if(n===String)return window.atob(e);const t=e.length;let o;for(o=0;o<3&&"="==e[t-(o+1)];o++);const i=(3*t+1>>2)-o,r=new(n||Array)(i);for(let n,o,c=0,l=0,a=0;a<t;a++)if(o=3&a,c|=((s=e.charCodeAt(a))>64&&s<91?s-65:s>96&&s<123?s-71:s>47&&s<58?s+4:43===s?62:47===s?63:0)<<18-6*o,3===o||t-a==1){for(n=0;n<3&&l<i;n++,l++)r[l]=c>>>(16>>>n&24)&255;c=0}var s;return r}function _(){"all"!=window.debugging&&"channel"!=window.debugging||console.debug.apply(console,arguments)}function E(e,n){Object.defineProperties(e,{addEventListener:{enumerable:!1,value:function(e,t){void 0===n[e]&&(n[e]=[]),n[e].push(t)}},removeEventListener:{enumerable:!1,value:function(e,t){const o=n[e]?n[e].length:0;for(let i=0;i<o;i++)if(n[e][i]===t){n[e][i]=null;break}}},dispatchEvent:{enumerable:!1,value:function(o){let i,r;if("string"==typeof o){i=o,r=Array.prototype.slice.call(arguments,1);let e=null;2==arguments.length?e=arguments[1]:arguments.length>2&&(e=r),o=new CustomEvent(i,{bubbles:!1,cancelable:!1,detail:e}),r.unshift(o)}else i=o.type,r=arguments;t(e["on"+i])&&e["on"+i].apply(e,r),s(n[i],e,r)}}})}function S(){let n=window.location.pathname||"/",t=e;return window.mock&&window.mock.pathname&&(n=window.mock.pathname),window.mock&&window.mock.url_root&&(t=window.mock.url_root),t&&0===n.indexOf("/"+t)&&(n=n.replace("/"+t,"")||"/"),0!==n.indexOf("/cockpit/")&&0!==n.indexOf("/cockpit+")&&(n=0===n.indexOf("/=")?"/cockpit+"+n.split("/")[1]:"/cockpit"),n.split("/")[1]}function x(n){n||(n="socket");const t=window.location.toString();let o=e;if(window.mock&&window.mock.url)return window.mock.url;window.mock&&window.mock.url_root&&(o=window.mock.url_root);let i=S();return o&&(i=o+"/"+i),0===t.indexOf("http:")?"ws://"+window.location.host+"/"+i+"/"+n:0===t.indexOf("https:")?"wss://"+window.location.host+"/"+i+"/"+n:(_("Cockpit must be used over http or https"),null)}function j(e,n){if(!n)return e.join("");let t=0;const o=e.length;for(let n=0;n<o;n++)t+=e[n].length;const i=window.Uint8Array?new window.Uint8Array(t):new Array(t);if(i.set)for(let n=0,t=0;t<o;t++)i.set(e[t],n),n+=e[t].length;else for(let n=0,t=0;t<o;t++){for(let o=0;o<e[t].length;o++)i[t+n]=e[t][o];n+=e[t].length}return i}function O(e){const n=this;n.readyState=0,window.addEventListener("message",(function(t){if(t.origin!==w||t.source!==e)return;const o=t.data;void 0===o||void 0===o.length&&void 0===o.byteLength||(0===o.length?(n.readyState=3,n.onclose()):n.onmessage(t))}),!1),n.send=function(n){e.postMessage(n,w)},n.close=function(){n.readyState=3,e.postMessage("",w),n.onclose()},window.setTimeout((function(){n.readyState=1,n.onopen()}),0)}function L(e){let n;if(e instanceof window.ArrayBuffer){const t=new window.Uint8Array(e),o=t.length;let i;for(i=0;i<o&&10!=t[i];i++);if(i===o)return console.warn("binary message without channel"),null;if(0===i)return console.warn("binary control message"),null;n=String.fromCharCode.apply(null,t.subarray(0,i))}else{const t=e.indexOf("\n");if(-1===t)return console.warn("text message without channel"),null;n=e.substring(0,t)}return n}function A(){const e=this;e.application=S(),E(e,{});let n,t=0,o="";window.mock&&(window.mock.last_transport=e);let i,r=!1,s=!1;window.parent!==window&&0===window.name.indexOf("cockpit1:")&&(n=new O(window.parent));try{!n&&window.parent!==window&&window.parent.options&&"cockpit1"==window.parent.options.protocol&&(n=new O(window.parent))}catch(e){}if(!n){const t=x();_("connecting to "+t),t&&("WebSocket"in window?n=new window.WebSocket(t,"cockpit1"):"MozWebSocket"in window?n=new window.MozWebSocket(t):console.error("WebSocket not supported, application will not work!")),i=window.setInterval((function(){e.ready&&n.send('\n{ "command": "ping" }'),s||(r?console.log("health check failure ignored"):(console.log("health check failed"),e.close({problem:"timeout"}))),s=!1}),3e4)}n||(n={close:function(){}},window.setTimeout((function(){e.close({problem:"no-cockpit"})}),50));const c={},l={};let w=!0;function b(){e.ready||(e.ready=!0,e.dispatchEvent("ready"))}e.ready=!1,n.onopen=function(){n&&(void 0!==n.binaryType&&(n.binaryType="arraybuffer"),n.send('\n{ "command": "init", "version": 1 }'))},n.onclose=function(){_("WebSocket onclose"),n=null,u&&(d=!0,window.location.reload(!0)),e.close()},n.onmessage=e.dispatch_data=function(n){s=!0;const t=n.data,i=L(t);if(null===i)return!1;const r=t instanceof window.ArrayBuffer?new window.Uint8Array(t,i.length+1):t.substring(i.length+1);let u;i?_("recv "+i+":",r):(_("recv control:",r),u=JSON.parse(r));const d=g?g.length:0;for(let e=0;e<d;e++)if(!1===g[e](t,i,u))return!1;return i?function(e,n){const t=l[e];t&&t(n)}(i,r):function(n){const t=n.channel;if("init"==n.command)!function(n){if(n.problem)return void e.close({problem:n.problem});if(1!==n.version)return console.error("received unsupported version in init message: "+n.version),void e.close({problem:"not-supported"});n["channel-seed"]&&(o=String(n["channel-seed"]));n.host&&(p=n.host);a&&(a.options=n,a.csrf_token=n["csrf-token"],a.host=p);f&&f(n);w&&(w=!1,b())}(n);else if(w)w=!1,("close"!=n.command||t)&&(console.error("received message before init: ",n.command),n={problem:"protocol-error"}),e.close(n);else if("ping"==n.command)n.command="pong",e.send_control(n);else if("pong"==n.command);else if("hint"==n.command)h&&h(n);else if(void 0!==t){const e=c[t];e&&e(n)}}(u),!0},e.close=function(e){e||(e={problem:"disconnected"}),e.command="close",window.clearInterval(i);const t=n;if(n=null,t&&t.close(),!d){b();for(const n in c)c[n].apply(null,[e])}},e.next_channel=function(){return t++,o+String(t)},e.send_data=function(e,t,o){if(!n)return!1;const i=m?m.length:0;for(let n=0;n<i;n++)if(void 0===t&&(t=L(e)),t||void 0!==o||(o=JSON.parse(e)),!1===m[n](e,t,o))return!1;return n.send(e),!0},e.send_message=function(n,t,o){if(_(t?"send "+t:"send control:",n),n.byteLength||Array.isArray(n)){n instanceof window.ArrayBuffer&&(n=new window.Uint8Array(n));const i=j([v(t),[10],n],!0);return e.send_data(i.buffer,t,o)}return e.send_data(t.toString()+"\n"+n,t,o)},e.send_control=function(t){if(n||"close"!=t.command&&"kill"!=t.command){if(!i||"hint"!=t.command||"ignore_transport_health_check"!=t.hint)return e.send_message(JSON.stringify(t),"",t);r=t.data}},e.register=function(e,n,t){c[e]=n,l[e]=t},e.unregister=function(e){delete c[e],delete l[e]}}function C(e){l||(l=new A);const n=l;n.ready?e(n):n.addEventListener("ready",(function(){e(n)}))}function I(e){const t=this;let o;E(t,{});let i=null,r=null,s=null,c=!1,l=!1,a=null;const u=!0===e.binary,d=[];function f(e){c?(console.warn("received message after done"),t.close("protocol-error")):t.dispatchEvent("message",e)}function h(n){r=n,t.valid=!1,o&&a&&o.unregister(a),r.message&&!e.err&&console.warn(r.message),t.dispatchEvent("close",r),s&&s.resolve(r)}function g(e){if("close"==e.command)return void h(e);"ready"==e.command&&function(e){i=e,t.dispatchEvent("ready",i)}(e);const n="done"===e.command;n&&c?(console.warn("received two done commands on channel"),t.close("protocol-error")):(n&&(c=!0),t.dispatchEvent("control",e))}function m(e){u||"string"!=typeof e&&(e=String(e)),o.send_message(e,a)}t.valid=!0,t.options=e,t.binary=u,t.id=a,C((function(n){if(o=n,r)return;a=o.next_channel(),t.id=a,o.register(a,g,f);const i={};for(const n in e)i[n]=e[n];for(i.command="open",i.channel=a,i.host||p&&(i.host=p),u?i.binary="raw":delete i.binary,i["flow-control"]=!0,o.send_control(i);d.length>0;){const e=d.shift();e[0]?(e[1].channel=a,o.send_control(e[1])):m(e[1])}})),t.send=function(e){r?console.warn("sending message on closed channel"):l?console.warn("sending message after done"):o?m(e):d.push([!1,e])},t.control=function(e){(e=e||{}).command||(e.command="options"),"done"===e.command&&(l=!0),e.channel=a,o?o.send_control(e):d.push([!0,e])},t.wait=function(e){s||(s=n.defer(),r?s.reject(r):i?s.resolve(i):(t.addEventListener("ready",(function(e,n){s.resolve(n)})),t.addEventListener("close",(function(e,n){s.reject(n)}))));const o=s.promise;return e&&o.then(e,e),o},t.close=function(e){r||(e?"string"==typeof e&&(e={problem:e}):e={},e.command="close",e.channel=a,o?o.send_control(e):d.push([!0,e]),h(e))},t.buffer=function(e){const n=[];function o(e,o){if(n.push(o),n.callback){const e=j(n,u);if(e.length>0){const o=n.callback.call(t,e);"number"!=typeof o||o===e.length?n.length=0:0===o?(n.length=1,n[0]=e):0!==o&&(n.length=1,e.subarray?n[0]=e.subarray(o):e.substring?n[0]=e.substring(o):n[0]=e.slice(o))}}}return n.callback=e,n.squash=function(){return j(n,u)},t.addEventListener("message",o),t.addEventListener("close",(function e(){t.removeEventListener("message",o),t.removeEventListener("close",e)})),n},t.toString=function(){const n=e.host||"localhost";return"[Channel "+(t.valid?a:"<invalid>")+" -> "+n+"]"}}w||(w=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),window.addEventListener("beforeunload",(function(){d=!0}),!1),window.addEventListener("unload",(function(){l&&l.close()})),window.cockpit=function(){function d(e){this.encoding="utf-8",this.encode=function(n,t){const o=window.unescape(encodeURIComponent(n));return e===String?o:v(o,e)}}function b(e){let n=null;this.encoding="utf-8",this.decode=function(t,o){const i=o&&o.stream;null==t&&(t=""),"string"!=typeof t&&(t=function(e){const n=e.length;let t="";for(let o=0;o<n;o++)t+=String.fromCharCode(e[o]);return t}(t)),n&&(t=n+t,n=null);const r=t.length;let s=0,c=0,l="";for(;c<r;){const o=t.charCodeAt(c),a=255==o?0:o>251&&o<254?6:o>247&&o<252?5:o>239&&o<248?4:o>223&&o<240?3:o>191&&o<224?2:o<128?1:0;let u=c+a<=r;if(!u&&i){n=t.substring(c);break}0===a&&(u=!1);for(let e=1;u&&e<a;e++)u=0!=(128&t.charCodeAt(c+e));if(u)c+=a;else{if(e){c=r;break}l+=decodeURIComponent(window.escape(t.substring(s,c))),l+="ï¿½",c++,s=c}}return l+=decodeURIComponent(window.escape(t.substring(s,c))),l}}n.channel=function(e){return new I(e)},n.event_target=function(e){return E(e,{}),e},n.extend=Object.assign,n.manifests={},n.utf8_encoder=function(e){return new d(e)},n.utf8_decoder=function(e){return new b(!!e)},n.base64_encode=y,n.base64_decode=k,n.kill=function(e,t){const o={};e&&(o.host=e),t&&(o.group=t),n.transport.control("kill",o)},n.hint=function(e,t){l&&(t||(t=p),"string"==typeof t&&(t={host:t}),t.hint=e,n.transport.control("hint",t))},n.transport=a={wait:C,inject:function(e,n){return!!l&&(void 0===n||n?l.send_data(e):l.dispatch_data({data:e}))},filter:function(e,n){n?(m||(m=[]),m.push(e)):(g||(g=[]),g.push(e))},close:function(e){l&&l.close(e?{problem:e}:void 0),l=null,this.options={}},origin:w,options:{},uri:x,control:function(e,n){n={...n,command:e},C((function(e){e.send_control(n)}))},application:function(){return!l||window.mock?S():l.application}};let _=[],O=null;function L(){const e=_;for(O=null,_=[];;){const n=e.shift();if(!n)break;n()}}function A(e){e&&_.push(e),null===O&&(O=window.setTimeout(L,0))}function B(e,n,t,o){if(void 0===n&&void 0===t&&void 0===o)return null;const i=new P;return e.pending=e.pending||[],e.pending.push([i,n,t,o]),e.status>0&&M(e),i.promise}function M(e){!e.process_scheduled&&e.pending&&(e.process_scheduled=!0,A((function(){!function(e){const n=e.pending;e.process_scheduled=!1,e.pending=void 0;for(let o=0,i=n.length;o<i;++o){e.pur=!0;const i=n[o][0],r=n[o][e.status];t(r)?i.resolve(r.apply(e.promise,e.values)):1===e.status?i.resolve.apply(i.resolve,e.values):i.reject.apply(i.reject,e.values)}}(e)})))}function N(e,n){let i,r=!1;(o(n[0])||t(n[0]))&&(i=n[0]&&n[0].then),t(i)?(e.status=-1,i.call(n[0],(function(){r||(r=!0,N(e,arguments))}),(function(){r||(r=!0,U(e,arguments))}),(function(){J(e,arguments)}))):(e.values=n,e.status=1,M(e))}function U(e,n){e.values=n,e.status=2,M(e)}function J(e,n){const o=e.pending;e.status<=0&&o&&o.length&&A((function(){for(let i=0,r=o.length;i<r;i++){const r=o[i][0],s=o[i][3];t(s)?r.notify(s.apply(e.promise,n)):r.notify.apply(r,n)}}))}function P(){const e=this,n={};e.promise=n.promise=function(e){const n=function(e){return e?(Object.assign(e,n),e):n};return e.status=0,n.then=function(t,o,i){return B(e,t,o,i)||n},n.catch=function(t){return B(e,null,t)||n},n.finally=function(t,o){return B(e,(function(){return D(arguments,!0,t)}),(function(){return D(arguments,!1,t)}),o)||n},n.done=function(t){return B(e,t),n},n.fail=function(t){return B(e,null,t),n},n.always=function(t){return B(e,t,t),n},n.progress=function(t){return B(e,null,null,t),n},n.state=function(){return 1==e.status?"resolved":2==e.status?"rejected":"pending"},n.promise=n,n}(n),e.resolve=function(){if(arguments[0]===n.promise)throw new Error("Expected promise to be resolved with other value than itself");return n.status||N(n,arguments),e},e.reject=function(){if(!n.status)return U(n,arguments),e},e.notify=function(){return J(n,arguments),e}}function T(e,t){const o=n.defer();return t?o.resolve.apply(o,e):o.reject.apply(o,e),o.promise}function D(e,n,o){let i=null;return t(o)&&(i=o()),i&&t(i.then)?i.then((function(){return T(e,n)}),(function(){return T(arguments,!1)})):T(e,n)}n.when=function(e,t,o,i){const r=n.defer();return r.resolve(e),r.promise.then(t,o,i)},n.resolve=function(e){return n.defer().resolve(e).promise},n.reject=function(e){return n.defer().reject(e).promise},n.defer=function(){return new P};const q=/\$\{([^}]+)\}|\$([a-zA-Z0-9_]+)/g;function R(e,t,o,i){let r=null;if(e||0===e){if("string"==typeof o){const n=[];for(const e in t)n.push(e);n.sort().reverse();for(let i=0;i<n.length;i++){for(let s=0;s<t[n[i]].length;s++)if(o==t[n[i]][s]){e/=Math.pow(n[i],s),r=o;break}if(r)break}}else if(o in t){let n=1;for(let i=0;i<t[o].length;i++){const s=e/n;if(s<o){e=s,r=t[o][i];break}n*=o}}}else r=null;const s=n.format_number(e);let c;return c=s&&r?[s,r]:[s],i||(c=c.join(" ")),c}n.format=function(e,n){function t(e,t,o){const i=n[t||o];return 0===i?"0":i||""}return 2==arguments.length&&o(n)&&null!==n||(n=Array.prototype.slice.call(arguments,1)),e.replace(q,t)},n.format_number=function(e){const t=void 0===n.language?void 0:n.language.replace("_","-");return e||0===e?e%1==0?e.toString():e>0&&e<=.001?.001.toLocaleString(t):e<0&&e>=-.001?(-.001).toLocaleString(t):e>999||e<-999?e.toFixed(0):e.toLocaleString(t,{maximumSignificantDigits:3,minimumSignificantDigits:3}):""};const $={1e3:[null,"KB","MB","GB","TB","PB","EB","ZB"],1024:[null,"KiB","MiB","GiB","TiB","PiB","EiB","ZiB"]};n.format_bytes=function(e,n,t){return void 0===n&&(n=1024),R(e,$,n,t)},n.get_byte_units=function(e,n){function t(e){return{name:$[n][e],factor:Math.pow(n,e)}}void 0!==n&&n in $||(n=1024);const o=[t(2),t(3),t(4)];for(let n=o.length-1;n>=0;n--)if(0===n||e/o[n].factor>=10){o[n].selected=!0;break}return o};const G={1024:["B/s","KiB/s","MiB/s","GiB/s","TiB/s","PiB/s","EiB/s","ZiB/s"]};n.format_bytes_per_sec=function(e,n,t){return void 0===n&&(n=1024),R(e,G,n,t)};const H={1e3:["bps","Kbps","Mbps","Gbps","Tbps","Pbps","Ebps","Zbps"]};function K(e){const t=this;let o;try{o=window[e]}catch(e){}t.prefixedKey=function(e){return n.transport.application()+":"+e},t.getItem=function(e,n){let i=o.getItem(t.prefixedKey(e));return!i&&n&&(i=o.getItem(e)),i},t.setItem=function(e,n,i){o.setItem(t.prefixedKey(e),n),i&&o.setItem(e,n)},t.removeItem=function(e,n){o.removeItem(t.prefixedKey(e)),n&&o.removeItem(e)},t.clear=function(e){let t=0;for(;t<o.length;){const i=o.key(t);e&&0!==i.indexOf("cockpit")||0===i.indexOf(n.transport.application())?o.removeItem(i):t++}}}function z(e){let n;if(e.parent&&e.parent!==e&&(n=z(e.parent)),!n)try{n=e["cv1-storage"],n||(e["cv1-storage"]=n={})}catch(e){}return n}function W(e,t,o){const i=this,r=n.transport.application()+":"+e,s=window.sessionStorage;let c;const l=z(window);let a,u=!1;function d(){if(void 0!==l[r]){const n=l[r];window.setTimeout((function(){!1===o(n,e)&&i.close()}))}}function f(e){if(a&&!u&&(u=!0),!u)return;const n=Math.floor(1e7*Math.random())+1,t=document.createEvent("StorageEvent");t.initStorageEvent("storage",!1,!1,r,null,n,window.location,s),l[r]=e,s.setItem(r,n),t.self=i,window.dispatchEvent(t)}function p(){if(a&&a.close&&a.close(),a=null,!u)return;u=!1;let e=s.getItem(r);if(e=e?parseInt(e,10):null,c&&c===e){const e=document.createEvent("StorageEvent"),n=s[r];e.initStorageEvent("storage",!1,!1,r,n,null,window.location,s),delete l[r],s.removeItem(r),e.self=i,window.dispatchEvent(e)}}function h(e){if(e.key!==r)return;if(e.self!==i){if(!e.newValue&&!u)return void i.claim()}else u&&!e.oldValue&&e.newValue!==s.getItem(r)&&p();let n=null;e.newValue&&(n=parseInt(e.newValue,10)),c!==n&&(c=n,d())}i.claim=function(){if(a)return;const n={close:function(){}};a=n;const o=t(f,e);a===n?a=o:o.close()},i.close=function(){window.removeEventListener("storage",h,!0),p()},window.addEventListener("storage",h,!0),window.addEventListener("beforeunload",(function(){i.close()})),window.addEventListener("unload",(function(){i.close()})),s.getItem(r)?d():i.claim()}function V(e,n,t){const o=this;o.interval=e,o.limit=n?65536:1024;const i=function(e){if(!e)return[];const n=z(window);let t=n[e];t||(n[e]=t=[]);return t}(n);let r=0,s=null,c=null;function l(e,n){let t=0,o=e.length-1;for(;t<=o;){const i=(t+o)/2|0,r=e[i].beg;if(r<n)t=i+1;else{if(!(r>n))return i;o=i-1}}return t}function a(e,n,o){t&&(o||u(e,new Array(n-e),{}),t(e,n,o))}function u(e,n,t){if(!n.length)return;let a=l(i,e);const u=e+n.length,d=i.length;let f;for(f=a>0?a-1:a;f<d;f++){const n=i[f],t=n.items.length;if(!t)continue;const o=n.beg,s=Math.max(o,e),c=Math.min(o+t,u);if(s<c){const e=c-s;n.items.splice(s-o,e),r-=e,s-o==0&&(n.beg+=c-o)}else if(f>=a)break}const p={beg:e,items:n,mapping:t};for(s||(s=p),c&&(c.next=p),c=p,r+=n.length,i.splice(a,0,p),a--;a<=f;a++){const e=i[a];e&&!e.items.length&&(i.splice(a,1),a--)}for(;s&&r>o.limit;)r-=s.items.length,s.items=[],s.mapping=null,s=s.next||null;const h=i.length;for(f=0;f<h&&!(i[f].items.length>0);f++);i.splice(0,f)}o.load=function(e,n,t){if(n<=e)return;const o=l(i,e),r=i.length;let s=e;const c=[];for(let t=o>0?o-1:o;t<r;t++){const r=i[t],l=r.items.length;if(!l)continue;const a=r.beg,u=Math.max(a,e),d=Math.min(a+l,n);if(u<d)u>s&&c.push([s,u]),f(u,r.items.slice(u-a,d-a),r.mapping),s=d;else if(t>=o)break}for(let e=0;e<c.length;e++)a(c[e][0],c[e][1],t);s!=n&&a(s,n,t)};const d={};function f(e,n,t){const o=e+n.length;for(const i in d){const r=d[i],s=r.grid,c=Math.max(e,s.beg),l=Math.min(o,s.end);if(c<l){const o=c-e,i=c-s.beg,a=l-c;for(let e=0;e<a;e++){const s=r.links.length;for(let c=0;c<s;c++){const s=r.links[c][0],l=r.links[c][1];let a=n[o+e],u=t;const d=s.length;for(let e=0;void 0!==a&&e<d;e++)a?null!=u?(u=u[s[e]],a=u?a[u[""]]:a[s[e]]):a=a[s[e]]:a=void 0;l[i+e]=a}}s.notify(i,a)}}}o._register=function(n,t){if(n.interval!=e)throw Error("mismatched metric interval between grid and sink");let o=d[t];return o||(o=d[t]={grid:n,links:[]},o.links.remove=function(){delete d[t]}),o.links},o.input=function(e,n,t){f(e,n,t),u(e,n,t)},o.close=function(){for(const e in d){const n=d[e];n&&n.grid&&n.grid.remove_sink(o)}}}n.format_bits_per_sec=function(e,n,t){return void 0===n&&(n=1e3),R(e,H,n,t)},n.localStorage=new K("localStorage"),n.sessionStorage=new K("sessionStorage"),n.cache=function(e,n,t){return new W(e,n,t)},n.series=function(e,n,t){return new V(e,n,t)};let Z=1;function F(e,n,i){const s=this;E(s,{});const c=[];s.interval=e,s.beg=0,s.end=0;const l=[],a=[];let u=0;const d="g1-"+Z;Z+=1;let f=null,p=null;function h(e,n,t){void 0===n&&(n=e+(s.end-s.beg)),n<e&&(e=n),s.beg=e,s.end=n,c.length&&(c.forEach((function(e){e.length=0})),s.sync(t))}function g(){window.clearInterval(f),f=null,p=null}s.notify=function(e,n){if(u)return;if(e+n>s.end-s.beg&&(n=s.end-s.beg-e),n<=0)return;const t=l.length;for(let o=0;o<t;o++){const t=l[o][0],i=l[o][1];t.call(s,i,e,n)}s.dispatchEvent("notify",e,n)},s.add=function(){const e=[];if(c.push(e),o(arguments[0])){const n=arguments[0].series||arguments[0];let t=arguments[1];t?"string"==typeof t&&(t=t.split(".")):t=[];const o=n._register(s,d);o.length||a.push({sink:n,links:o}),o.push([t,e])}else if(t(arguments[0])){const n=[arguments[0],e];!0===arguments[1]?l.unshift(n):l.push(n)}else if(0!==arguments.length)throw Error("invalid args to grid.add()");return e},s.remove=function(e){let n=a.length;for(let t=0;t<n;t++){const n=a[t].links.length;for(let o=0;o<n;o++)if(a[t].links[o][1]===e){a[t].links.splice(o,1);break}}n=c.length;for(let t=0;t<n;t++)if(c[t]===e){c.splice(t,1);break}},s.remove_sink=function(e){const n=a.length;for(let t=0;t<n;t++)if(a[t].sink===e){a[t].links.remove(),a.splice(t,1);break}},s.sync=function(e){u++;const n=a.length;for(let t=0;t<n;t++){a[t].sink.load(s.beg,s.end,e)}u--,s.notify(0,s.end-s.beg)},s.move=function(e,n){g();let t=null;void 0===e?e=0:r(e)&&(t=Date.now(),e=Math.floor(t/s.interval)+e),void 0!==n&&r(n)&&(null===t&&(t=Date.now()),n=Math.floor(t/s.interval)+n),h(e,n,!1)},s.walk=function(){const e=Date.now();s.interval>2e9||(g(),p=e-s.beg*s.interval,f=window.setInterval((function(){const e=Date.now();h(Math.floor((e-p)/s.interval),void 0,!0)}),s.interval))},s.close=function(){for(g();a.length;)a.pop().links.remove()},s.move(n,i)}function Y(e,t){this.problem=e,this.message=t||n.message(e),this.toString=function(){return this.message}}n.grid=function(e,n,t){return new F(e,n,t)},n.logout=function(e,t){n.sessionStorage.clear(!0),n.localStorage.removeItem("login-data",!0),n.localStorage.clear(!1),!1!==e&&(u=!0),C((function(e){e.send_control({command:"logout",disconnect:!0})||window.location.reload(u)})),window.sessionStorage.setItem("logout-intent","explicit"),t&&window.sessionStorage.setItem("logout-reason",t)},n.drop_privileges=function(){C((function(e){e.send_control({command:"logout",disconnect:!1})}))},n.info={},E(n.info,{}),f=function(e){e.system&&Object.assign(n.info,e.system),e.system&&n.info.dispatchEvent("changed")};let Q=null;n.user=function(){const e=n.defer();if(Q)e.resolve(Q);else{const t=n.dbus(null,{bus:"internal"});t.call("/user","org.freedesktop.DBus.Properties","GetAll",["cockpit.User"],{type:"s"}).then((n=>{let[t]=n;Q={id:t.Id.v,name:t.Name.v,full_name:t.Full.v,groups:t.Groups.v,home:t.Home.v,shell:t.Shell.v},e.resolve(Q)})).catch((n=>e.reject(n))).finally((()=>t.close()))}return e.promise},document.addEventListener("click",(function(e){e.target.classList&&function(e,n){const t=e.length;for(let o=0;o<t;o++)if(n===e[o])return!0;return!1}(e.target.classList,"disabled")&&e.stopPropagation()}),!0);let X=null;function ee(){return window.location.href.split("#")[1]||""}function ne(){const t=this,o=n.transport.application();t.url_root=e||"",0===o.indexOf("cockpit+=")&&(t.url_root&&(t.url_root+="/"),t.url_root=t.url_root+o.replace("cockpit+",""));const i=ee(),r={};function s(e){const n=e.split("/").map(decodeURIComponent);let o,i,r=[];for(t.url_root&&(r=t.url_root.split("/").map(decodeURIComponent)),e&&"/"!==e[0]?(o=[].concat(t.path),o.pop(),o=o.concat(n)):o=n,o=function(e){const n=[],t=e.length;for(let o=0;o<t;o++){const t=e[o];if(""!==t&&"."!=t)if(".."==t){if(0===n.length)return null;n.pop()}else n.push(t)}return n}(o),i=0;i<r.length&&r[i]===o[i];i++);return i==r.length&&o.splice(0,r.length),o}function c(e,n,o){"string"==typeof e&&(e=s(e));let i,r="/"+e.map(encodeURIComponent).join("/");o&&t.url_root&&r.indexOf("/"+t.url_root+"/"!==0)&&(r="/"+t.url_root+r),r=r.replace("%40","@"),r=r.replace("%3D","="),r=r.replace(/%2B/g,"+");const c=[];function l(e){c.push(encodeURIComponent(i)+"="+encodeURIComponent(e))}if(n){for(i in n){let e=n[i];Array.isArray(e)||(e=[e]),e.forEach(l)}c.length>0&&(r+="?"+c.join("&"))}return r}function l(e,n){"#"==e[0]&&(e=e.substr(1));const t=e.indexOf("?");let o=e;o=-1===t?e:e.substr(0,t);const i=s(o);return-1!==t&&n&&e.substring(t+1).split("&").forEach((function(e){const t=e.split("="),o=decodeURIComponent(t[0]),i=decodeURIComponent(t[1]);if(n[o]){let e=n[o];Array.isArray(i)||(e=n[o]=[e]),e.push(i)}else n[o]=i})),i}function a(){let e;if(1==arguments.length&&arguments[0]instanceof ne)e=String(arguments[0]);else if("string"==typeof arguments[0]){const n=arguments[1]||{};e=c(l(arguments[0],n),n)}else e=c.apply(t,arguments);return e}t.path=l(i,r),Object.defineProperties(t,{path:{enumerable:!0,writable:!1,value:t.path},options:{enumerable:!0,writable:!1,value:r},href:{enumerable:!0,value:i},go:{value:function(){if(t!==X)return;const e=a.apply(t,arguments);window.location.hash="#"+e}},replace:{value:function(){if(t!==X)return;const e=a.apply(t,arguments);window.location.replace(window.location.pathname+"#"+e)}},encode:{value:c},decode:{value:l},toString:{value:function(){return i}}})}function te(e,t){this.problem=e.problem||null,this.exit_status=e["exit-status"],void 0===this.exit_status&&(this.exit_status=null),this.exit_signal=e["exit-signal"],void 0===this.exit_signal&&(this.exit_signal=null),this.message=e.message,void 0===this.message?this.problem?this.message=n.message(e.problem):null!==this.exit_signal?this.message=n.format(he("$0 killed with signal $1"),t,this.exit_signal):void 0!==this.exit_status?this.message=n.format(he("$0 exited with code $1"),t,this.exit_status):this.message=n.format(he("$0 failed"),t):this.message=this.message.trim(),this.toString=function(){return this.message}}function oe(){"all"!=window.debugging&&"spawn"!=window.debugging||console.debug.apply(console,arguments)}function ie(){"all"!=window.debugging&&"dbus"!=window.debugging||console.debug.apply(console,arguments)}function re(e,t){"string"==typeof e?(this.problem=e,this.name=null,this.message=t||n.message(e)):(this.problem=null,this.name=e[0],this.message=e[1][0]||e[0]),this.toString=function(){return this.message}}function se(){const e=this;let n=[];function t(e,t,o){const i=n.slice(),r=i.length;for(let n=0;n<r;n++){const r=i[n];r[0]&&r[0]!==e||r[1]&&r[1]!==t||r[2](o,e)}}e.data={},e.meta={},e.connect=function(e,t,o,i){const r=[e,t,o];return i?n.unshift(r):n.push(r),{remove:function(){const i=n.length;for(let r=0;r<i;r++){const i=n[r];if(i[0]===e&&i[1]===t&&i[2]===o){delete i[r];break}}}}},e.update=function(n,o,i){e.data[n]||(e.data[n]={}),e.data[n][o]?i=Object.assign(e.data[n][o],i):e.data[n][o]=i,t(n,o,i)},e.remove=function(n,o){e.data[n]&&(delete e.data[n][o],t(n,o,null))},e.lookup=function(n,t){if(e.data[n])return e.data[n][t]},e.each=function(n,t){for(const o in e.data)for(const i in e.data[o])i==n&&t(e.data[o][n],o)},e.close=function(){e.data={};const t=n;n=[];const o=t.length;for(let e=0;e<o;e++)t[e].callback()}}function ce(e,t,o,i,r){const s=this;E(s,{});let c=!1,l=!1;const a=n.defer();function u(r){r?(Object.assign(s.data,r),l||function(){if(!t.meta[o])return;const r=t.meta[o];l=!0,Object.keys(r.methods||{}).forEach((function(t){t[0].toLowerCase()!=t[0]&&Object.defineProperty(s,t,{enumerable:!1,value:function(){const r=n.defer();return e.call(i,o,t,Array.prototype.slice.call(arguments)).done((function(e){r.resolve.apply(r,e)})).fail((function(e){r.reject(e)})),r.promise}})})),Object.keys(r.properties||{}).forEach((function(t){if(t[0].toLowerCase()==t[0])return;const c={enumerable:!0,get:function(){return s.data[t]},set:function(e){throw Error(t+"is not writable")}},l=r.properties[t];l.flags&&-1!==l.flags.indexOf("w")&&(c.set=function(r){e.call(i,"org.freedesktop.DBus.Properties","Set",[o,t,n.variant(l.type,r)]).fail((function(e){console.log("Couldn't set "+o+" "+t+" at "+i+": "+e)}))}),Object.defineProperty(s,t,c)}))}(),c=!0):c=!1,s.dispatchEvent("changed",r)}function d(e){c?a.resolve():a.reject(e)}Object.defineProperties(s,{client:{value:e,enumerable:!1,writable:!1},path:{value:i,enumerable:!1,writable:!1},iface:{value:o,enumerable:!1,writable:!1},valid:{get:function(){return c},enumerable:!1},wait:{enumerable:!1,writable:!1,value:function(e){return e&&a.promise.always(e),a.promise}},call:{value:function(n,t,r){return e.call(i,o,n,t,r)},enumerable:!1,writable:!1},data:{value:{},enumerable:!1}}),"function"==typeof window.$&&Object.defineProperty(s,window.$.expando,{value:{},writable:!0,enumerable:!1}),r||(r={}),t.connect(i,o,u,!0),u(t.lookup(i,o)),e.subscribe({path:i,interface:o},(function(e,n,t,o){s.dispatchEvent("signal",t,o),t[0].toLowerCase()!=t[0]&&((o=o.slice()).unshift(t),s.dispatchEvent.apply(s,o))}),!1!==r.subscribe),!1!==r.watch?e.watch({path:i,interface:o}).always(d):d()}function le(e,t,o,i,r){const s=this;let c;E(s,{}),Object.defineProperties(s,{client:{value:e,enumerable:!1,writable:!1},iface:{value:o,enumerable:!1,writable:!1},path_namespace:{value:i,enumerable:!1,writable:!1},wait:{enumerable:!1,writable:!1,value:function(e){return e&&c.always(e),c}}}),"function"==typeof window.$&&Object.defineProperty(s,window.$.expando,{value:{},writable:!0,enumerable:!1});const l={interface:o,path_namespace:i};function a(n,t){let i=s[t];t&&(!n&&i?(delete s[t],s.dispatchEvent("removed",i)):n&&(i||(i=s[t]=e.proxy(o,t,r),s.dispatchEvent("added",i)),s.dispatchEvent("changed",i)))}e.subscribe(l),c=!1!==r.watch?e.watch(l):n.defer().resolve().promise,r={watch:!1,subscribe:!1,...r},t.connect(null,o,a,!1),t.each(o,a)}function ae(e,t){const o=this;E(o,{});const r={};let s=!1,c=null;t&&(t.track&&(s=!0),delete t.track,Object.assign(r,t)),r.payload="dbus-json3",e&&(r.name=e),o.options=t,o.unique_name=null,ie("dbus open: ",r);let l=n.channel(r);const a={},u={};let d,f,p={};function h(){d||(d=new se)}function g(e){return!(!l||!l.valid)&&(ie("dbus:",e),l.send(e),!0)}function m(e,t){let i;ie("dbus:",t);try{i=JSON.parse(t)}catch(e){console.warn("received invalid dbus json message:",e)}if(void 0===i)return void l.close({problem:"protocol-error"});const r=void 0!==i.id?p[i.id]:void 0;if(i.reply){if(r){const e={};i.type&&(e.type=i.type),i.flags&&(e.flags=i.flags),r.resolve(i.reply[0]||[],e),delete p[i.id]}}else i.error?r&&(r.reject(new re(i.error)),delete p[i.id]):A((function(){if(i.signal)for(const n in a){const t=a[n];t.callback&&(e=i.signal,(r=t.match).path&&e[0]!==r.path||r.path_namespace&&0!==e[0].indexOf(r.path_namespace)||r.interface&&e[1]!==r.interface||r.member&&e[2]!==r.member||r.arg0&&(!e[3]||e[3][0]!==r.arg0)||t.callback.apply(o,i.signal))}else i.call?function(e,t){const o=function(e){const t=e[0],o=e[1],i=e[2],r=u[t+"\n"+o],s=d.meta[o];return r&&s?s.methods&&i in s.methods?"function"!=typeof r[i]?function(e,n,t){return console.warn("method is not implemented properly: ",e,n,t),_(e,n,t)}(t,o,i):r[i].apply(r,e[3]):_(t,o,i):function(e,t){const o="DBus interface "+t+" not available at "+e;return n.reject(new re(["org.freedesktop.DBus.Error.UnknownInterface",[o]]))}(t,o)}(e);if(!t)return;n.when(o).then((function(){let e=Array.prototype.slice.call(arguments,0);1==e.length&&void 0===e[0]&&(e=[]),g(JSON.stringify({reply:[e],id:t}))}),(function(e){const o=[];o[0]=e.name||" org.freedesktop.DBus.Error.Failed",o[1]=[n.message(e)||o[0]],g(JSON.stringify({error:o,id:t}))}))}(i.call,i.id):i.notify?v(i.notify):i.meta?w(i.meta):void 0!==i.owner?(o.dispatchEvent("owner",i.owner),s&&c&&o.close(),c=i.owner):ie("received unexpected dbus json message:",t);var e,r}))}function w(e){h(),Object.assign(d.meta,e),o.dispatchEvent("meta",e)}function v(e){h();for(const n in e)for(const t in e[n]){const o=e[n][t];o?d.update(n,t,o):d.remove(n,t)}o.dispatchEvent("notify",e)}function b(e){f=e.problem||"disconnected";const n=p;p={};for(const t in n)n[t].reject(new re(f,e.message));o.dispatchEvent("close",e)}function y(e,n){ie("dbus ready:",t),o.unique_name=n["unique-name"]}o.constructors={"*":ce},o.wait=l.wait,o.meta=function(e,n){if(!l||!l.valid)return;const t={...n,meta:e};g(JSON.stringify(t)),w(e)},this.notify=v,this.close=function(e){"string"==typeof e&&(e={problem:e}),e||(e={}),l?l.close(e):b(e)},l.addEventListener("ready",y),l.addEventListener("message",m),l.addEventListener("close",(function e(n,t){ie("dbus close:",t),l.removeEventListener("ready",y),l.removeEventListener("message",m),l.removeEventListener("close",e),l=null,b(t)}));let k=1;function _(e,t,o){const i="DBus method "+t+" "+o+" not available at "+e;return n.reject(new re(["org.freedesktop.DBus.Error.UnknownMethod",[i]]))}this.call=function(e,t,o,i,r){const s=n.defer(),c=String(k);k++;const l={...r,call:[e,t,o,i||[]],id:c};return g(JSON.stringify(l))?p[c]=s:s.reject(new re(f)),s.promise},o.signal=function(e,n,t,o,i){if(!l||!l.valid)return;const r={...i,signal:[e,n,t,o||[]]};g(JSON.stringify(r))},this.subscribe=function(e,n,t){const o={match:{...e},callback:n};let i;return!1!==t&&g(JSON.stringify({"add-match":o.match})),n&&(i=String(k),k++,a[i]=o),{remove:function(){let e;i&&(e=a[i],e&&delete a[i]),!1!==t&&e&&g(JSON.stringify({"remove-match":e.match}))}}},o.watch=function(e){const t=i(e)?{...e}:{path:String(e)},o=String(k);k++;const r=n.defer();g(JSON.stringify({watch:t,id:o}))?p[o]=r:r.reject(new re(f));const s=r.promise;return s.remove=function(){o in p&&(r.reject(new re("cancelled")),delete p[o]),g(JSON.stringify({unwatch:t}))},s},o.publish=function(e,t,o,i){const r=[e,t],s=String(k);k++;const c=p[s]=n.defer();g(JSON.stringify({...i,publish:r,id:s}))?p[s]=c:c.reject(new re(f));const l=e+"\n"+t;c.promise.then((function(){u[l]=o}));const a=c.promise;return a.remove=function(){s in p&&(c.reject(new re("cancelled")),delete p[s]),delete u[l],g(JSON.stringify({unpublish:r}))},a},o.proxy=function(n,t,i){n||(n=e),n=String(n),t||(t="/"+n.replace(/\./g,"/"));let r=o.constructors[n];return r||(r=o.constructors["*"]),i||(i={}),h(),new r(o,d,n,String(t),i)},o.proxies=function(n,t,i){return n||(n=e),t||(t="/"),i||(i={}),h(),new le(o,d,String(n),String(t),i)}}Object.defineProperty(n,"location",{enumerable:!0,get:function(){return X&&X.href===ee()||(X=new ne),X},set:function(e){n.location.go(e)}}),window.addEventListener("hashchange",(function(){X=null;let e=window.location.hash;0===e.indexOf("#")&&(e=e.substring(1)),n.hint("location",{hash:e}),n.dispatchEvent("locationchanged")})),n.jump=function(e,t){e=Array.isArray(e)?"/"+e.map(encodeURIComponent).join("/").replace("%40","@").replace("%3D","=").replace(/%2B/g,"+"):""+e,void 0===t&&(t=n.transport.host);const o={command:"jump",location:e,host:t};n.transport.inject("\n"+JSON.stringify(o))},function(){let e,t=!1;function o(){let o=document[e];e&&void 0!==o||(o=!1),!1===o&&(o=t),n.hidden!==o&&(n.hidden=o,n.dispatchEvent("visibilitychange"))}void 0!==document.hidden?(e="hidden",document.addEventListener("visibilitychange",o)):void 0!==document.mozHidden?(e="mozHidden",document.addEventListener("mozvisibilitychange",o)):void 0!==document.msHidden?(e="msHidden",document.addEventListener("msvisibilitychange",o)):void 0!==document.webkitHidden&&(e="webkitHidden",document.addEventListener("webkitvisibilitychange",o)),h=function(e){"hidden"in e&&(t=e.hidden,o())},o()}(),n.spawn=function(e,t){const o=n.defer(),i={payload:"stream",spawn:[]};if(e instanceof Array)for(let n=0;n<e.length;n++)i.spawn.push(String(e[n]));else i.spawn.push(String(e));void 0!==t&&Object.assign(i,t);const r=i.spawn[0]||"process",s=n.channel(i),l=s.buffer(null);s.addEventListener("close",(function(e,n){const t=l.squash();oe("process closed:",JSON.stringify(n)),t&&oe("process output:",t),void 0!==n.message&&oe("process error:",n.message),n.problem?o.reject(new te(n,r)):n["exit-status"]||n["exit-signal"]?o.reject(new te(n,r),t):void 0!==n.message?o.resolve(t,n.message):o.resolve(t)}));const a=o.promise;return a.stream=function(e){return l.callback=e.bind(a),this},a.input=function(e,n){return null!=e&&(oe("process input:",e),c(e,(function(e){s.send(e)}))),n||s.control({command:"done"}),this},a.close=function(e){return oe("process closing:",e),s.valid&&s.close(e),this},a},n.script=function(e,t,o){!o&&i(t)&&(o=t,t=[]);const r=["/bin/sh","-c",e,"--"];return r.push.apply(r,t),n.spawn(r,o)};const ue={internal:null,session:null,system:null};n.dbus=function(e,n){n||(n={bus:"system"});const t=Object.keys(n),o=n.bus,i=!e&&1==t.length&&o in ue;if(i&&ue[o])return ue[o];const r=new ae(e,n);if(i){const e=r.close;r.close=function(){arguments.length>0&&e.apply(r,arguments)},r.addEventListener("close",(function(){ue[o]==r&&(ue[o]=null)})),ue[o]=r}return r},n.variant=function(e,n){return{v:n,t:e}},n.byte_array=function(e){return window.btoa(e)},n.file=function(e,t){const o=(t=t||{}).binary,i={path:e,read:u,replace:f,modify:function(e,t,o){const i=n.defer();function r(n,t){let o=e(n);void 0===o&&(o=n),f(o,t).done((function(e){i.resolve(o,e)})).fail((function(e){"change-conflict"==e.problem?s():i.reject(e)}))}function s(){u().done(r).fail((function(e){i.reject(e)}))}void 0===t?s():r(t,o);return i.promise},watch:function(e,n){e&&p.push(e);return g+=1,w(n),h=null,u(),{remove:function(){if(e){const n=p.indexOf(e);n>-1&&(p[n]=null)}g-=1,w(n)}}},close:function(){l&&l.close("cancelled");d&&d.close("cancelled");m&&m.close("cancelled")}},r={...t};delete r.syntax;let l,a=null;function u(){if(a)return a;const i=n.defer(),s={...r,payload:"fsread1",path:e};return function e(){l=n.channel(s);const r=[];l.addEventListener("message",(function(e,n){r.push(n)})),l.addEventListener("close",(function(n,s){if(l=null,"change-conflict"==s.problem)return void e();if(a=null,s.problem){const e=new Y(s.problem,s.message);return v(null,null,e),void i.reject(e)}let c;if("-"==s.tag)c=null;else try{u=j(r,o),c=t.syntax&&t.syntax.parse?t.syntax.parse(u):u}catch(e){return v(null,null,e),void i.reject(e)}var u;v(c,s.tag),i.resolve(c,s.tag)}))}(),a=i.promise,a}let d=null;function f(o,i){const s=n.defer();let l;try{l=null===o?null:(a=o,t.syntax&&t.syntax.stringify?t.syntax.stringify(a):a)}catch(e){return s.reject(e),s.promise}var a;d&&d.close("abort");const u={...r,payload:"fsreplace1",path:e,tag:i};return d=n.channel(u),d.addEventListener("close",(function(e,n){d=null,n.problem?s.reject(new Y(n.problem,n.message)):(v(o,n.tag),s.resolve(n.tag))})),c(l,(function(e){d.send(e)})),d.control({command:"done"}),s.promise}const p=[];let h,g=0,m=null;function w(t){if(g>0){if(m)return;const o={payload:"fswatch1",path:e,superuser:r.superuser};m=n.channel(o),m.addEventListener("message",(function(n,o){let i;try{i=JSON.parse(o)}catch(e){i=null}i&&i.path==e&&i.tag&&i.tag!=h&&(t&&void 0!==t.read&&!t.read?v(null,i.tag):u())}))}else m&&(m.close(),m=null)}function v(){h=arguments[1]||null,s(p,i,arguments)}return i};let de,fe={};function pe(e){return!0===e?1:e||0}n.language="en",n.locale=function(e){let t,o=n.language;e?(Object.assign(fe,e),t=e[""]):null===e&&(fe={}),t&&(t["plural-forms"]&&(de=t["plural-forms"]),t.language&&(o=t.language)),n.language=o},n.translate=function(){let e;e=0===arguments.length?[document]:1===arguments.length&&arguments[0].length?arguments[0]:arguments;const t=e.length;for(let o=0;o<t;o++){let t=null;if(e[o].querySelectorAll&&(t=e[o].querySelectorAll("[translatable], [translate]")),t)for(let e=0;e<t.length;e++){const o=t[e];let i=o.getAttribute("translate")||o.getAttribute("translatable")||"yes";if("no"==i)continue;const r=i.split(" ");i=o.getAttribute("translate-context")||o.getAttribute("context");for(let e=0;e<r.length;e++)"yes"==r[e]||"translate"==r[e]?o.textContent=n.gettext(i,o.textContent):r[e]&&o.setAttribute(r[e],n.gettext(i,o.getAttribute(r[e])||""));o.removeAttribute("translatable"),o.removeAttribute("translate")}}},n.gettext=function(e,n){1==arguments.length&&(n=e,e=void 0);const t=e?e+""+n:n;if(fe){const e=fe[t];if(e&&e[1])return e[1]}return n},n.ngettext=function(e,n,t,o){3==arguments.length&&(o=t,t=n,n=e,e=void 0);const i=e?e+""+n:n;if(fe&&de){const e=fe[i];if(e){const n=pe(de(o))+1;if(e[n])return e[n]}}return 1==o?n:t},n.noop=function(e,n){return arguments[arguments.length-1]};const he=n.gettext;function ge(e,n,t){this.status=parseInt(e,10),this.reason=n,this.message=t||n,this.problem=null,this.valueOf=function(){return this.status},this.toString=function(){return this.status+" "+this.message}}function me(){"all"!=window.debugging&&"http"!=window.debugging||console.debug.apply(console,arguments)}function we(e,n){if(e){n=n.toLowerCase();for(const t in e)if(t.toLowerCase()==n)return e[t]}}function ve(e,t){const o=this;o.options=t,t.payload="http-stream2";const r=[];if(void 0!==e)if(e.indexOf&&0===e.indexOf("/"))t.unix=e;else{const n=parseInt(e,10);if(isNaN(n))throw Error("The endpoint must be either a unix path or port number");t.port=n}function l(e){return Object.keys(e).map((function(n){return encodeURIComponent(n)+"="+encodeURIComponent(e[n])})).join("&").split("%20").join("+")}t.address&&(t.capabilities||(t.capabilities=[]),t.capabilities.push("address")),o.request=function(e){const o=n.defer(),i=o.promise;e.path||(e.path="/"),e.method||(e.method="GET"),e.params&&(-1===e.path.indexOf("?")?e.path+="?"+l(e.params):e.path+="&"+l(e.params)),delete e.params;const a=e.body;delete e.body;const u=e.headers;delete e.headers,Object.assign(e,t),t.headers&&u?e.headers={...t.headers,...u}:t.headers?e.headers=t.headers:e.headers=u,me("http request:",JSON.stringify(e));const d=n.channel(e);void 0!==a&&(""!==a&&(me("http input:",a),c(a,(function(e){d.send(e)}))),me("http done"),d.control({command:"done"}));let f=null,p=null,h=null;const g=d.buffer((function(e){return h&&h.status>=200&&h.status<=299&&f?f.call(i,e):0}));function m(e,n){"response"==n.command&&(h=n,p&&(h.headers=h.headers||{},s(p,i,[h.status,h.headers])))}return d.addEventListener("control",m),d.addEventListener("close",(function e(n,t){const s=r.indexOf(i);if(s>=0&&r.splice(s,1),t.problem)me("http problem: ",t.problem),o.reject(new Y(t.problem));else{const e=g.squash();if(h&&(h.status<200||h.status>299)){let n;const t=we(h.headers,"Content-Type");t&&!d.binary&&0===t.indexOf("text/plain")&&(n=e),me("http status: ",h.status),o.reject(new ge(h.status,h.reason,n),e)}else me("http done"),o.resolve(e)}d.removeEventListener("control",m),d.removeEventListener("close",e)})),i.stream=function(e){return f=e,i},i.response=function(e){return null===p&&(p=[]),p.push(e),i},i.input=function(e,n){return null!=e&&(me("http input:",e),c(e,(function(e){d.send(e)}))),n||(me("http done"),d.control({command:"done"})),i},i.close=function(e){return me("http closing:",e),d.close(e),i},r.push(i),i},o.get=function(e,n,t){return o.request({method:"GET",params:n,path:e,body:"",headers:t})},o.post=function(e,n,t){return t=t||{},i(n)||Array.isArray(n)?(n=JSON.stringify(n),void 0===we(t,"Content-Type")&&(t["Content-Type"]="application/json")):null==n?n="":"string"!=typeof n&&(n=String(n)),o.request({method:"POST",path:e,body:n,headers:t})},o.close=function(e){const n=r.slice();for(let t=0;t<n.length;t++)n[t].close(e)}}function be(e){const t=this;E(t,{});const o=n.dbus(null,{bus:"internal"}).proxy("cockpit.Superuser","/superuser");function i(){o.valid&&null!==t.allowed&&t.allowed!=("none"!=o.Current)&&window.location.reload(!0)}o.addEventListener("changed",i),t.allowed=null,t.user=e?e.user:null,t.is_superuser=e?e._is_superuser:null;let r=null,s=!1;function c(e){return 0===e.id||(r?!!(e.groups||[]).includes(r):s?t.is_superuser:void 0===e.id&&null)}e&&(r=e.group),e&&e.admin&&(s=!0),t.user&&null!==t.is_superuser?t.allowed=c(t.user):Promise.all([n.user(),new Promise(((e,t)=>{const o=n.channel({payload:"null",superuser:"require"});o.wait().then((()=>e(!0))).catch((()=>e(!1))).always((()=>o.close()))}))]).then((e=>{let[n,o]=e;t.user=n,t.is_superuser=o;const r=c(n);t.allowed!==r&&(t.allowed=r,i(),t.dispatchEvent("changed"))})),t.close=function(){}}function ye(e,t,o){const i=this;E(i,{}),void 0===t.length&&(t=[t]);const r=[];let s=!1;function c(t,o,l){if(0===t.length)return;if(!l){if(s)return;s=!0}const a={payload:"metrics1",interval:e,source:"internal",...t[0]};delete a.archive_source;const u=n.channel(a);r.push(u);let d,f=null,p=null;u.addEventListener("close",(function(e,n){l||(s=!1),t.length>1&&("not-supported"==n.problem||"not-found"==n.problem)?c(t.slice(1),o):n.problem?"terminated"==n.problem||"disconnected"==n.problem||"authentication-failed"==n.problem||"not-found"==n.problem&&l||"not-supported"==n.problem&&l||console.warn("metrics channel failed: "+n.problem):l&&(i.archives||(i.archives=!0,i.dispatchEvent("changed")))})),u.addEventListener("message",(function(n,r){const s=JSON.parse(r),c=s.length;if(void 0===c){f=s;let n=0;f.now&&f.timestamp&&(n=f.timestamp+(Date.now()-f.now)),d=Math.floor(n/e),o(d,f,null,t[0]),i.meta=f,i.dispatchEvent("changed")}else if(f){for(let e=0;e<c;e++){const n=s[e];if(p)for(let e=0;e<p.length;e++){const t=n[e];if(null==t)n[e]=p[e];else{const n=t.length;if(void 0!==n){const o=p[e],i=p[e].length;let r;for(r=0;r<n;r++)null===t[r]&&(t[r]=o[r]);for(;r<i;r++)t[r]=o[r]}}}p=n}o(d,f,s,t[0]),d+=c,f.timestamp+=e*c}}))}function l(e,n,t,o){let r=n.mapping;r||(r={},n.metrics.forEach((function(e,n){const t={"":n},i=o.metrics_path_names?o.metrics_path_names[n]:e.name;r[i]=t,e.instances&&e.instances.forEach((function(e,n){""===e&&(e="/"),t[e]={"":n}}))})),n.mapping=r),t&&i.series.input(e,t,r)}i.series=n.series(e,o,(function(e,n,t){t?i.follow():i.fetch(e,n)})),i.archives=null,i.meta=null,i.fetch=function(n,o){const i=n*e-Date.now(),r=o-n,s=[];for(let e=0;e<t.length;e++)t[e].archive_source&&s.push({...t[e],source:t[e].archive_source,timestamp:i,limit:r});c(s,l,!0)},i.follow=function(){c(t,l)},i.close=function(e){const n=r.length;i.series&&i.series.close();for(let t=0;t<n;t++)r[t].close(e)}}n.message=function(e){if(e.message)return e.message;let n=null;return n=e.problem?e.problem:e+"","terminated"==n?he("Your session has been terminated."):"no-session"==n?he("Your session has expired. Please log in again."):"access-denied"==n?he("Not permitted to perform this action."):"authentication-failed"==n?he("Login failed"):"authentication-not-supported"==n?he("The server refused to authenticate using any supported methods."):"unknown-hostkey"==n||"unknown-host"==n?he("Untrusted host"):"invalid-hostkey"==n?he("Host key is incorrect"):"internal-error"==n?he("Internal error"):"timeout"==n?he("Connection has timed out."):"no-cockpit"==n?he("Cockpit is not installed on the system."):"no-forwarding"==n?he("Cannot forward login credentials"):"disconnected"==n?he("Server has closed the connection."):"not-supported"==n?he("Cockpit is not compatible with the software on the system."):"no-host"==n?he("Cockpit could not contact the given host."):"too-large"==n?he("Too much data"):n},n.http=function(e,n){return i(e)&&void 0===n&&(n=e,e=void 0),new ve(e,n||{})},n.permission=function(e){return new be(e)},n.metrics=function(e,n){return new ye(e,n)},n.oops=function(){window.parent!==window&&0===window.name.indexOf("cockpit1:")&&window.parent.postMessage('\n{ "command": "oops" }',w)};const ke=window.onerror;return window.onerror=function(e,t,o){return n.oops(),!!ke&&ke(e,t,o)},n}()}()})();