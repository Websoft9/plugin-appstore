{"ast":null,"code":"import _slicedToArray from\"/data/stackhub-web/plugins/myapps/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import cockpit from\"cockpit\";import React from\"react\";import\"../assets/scss/custom/terminal/context-menu.css\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var _=cockpit.gettext;export var ContextMenu=function ContextMenu(_ref){var parentId=_ref.parentId,getText=_ref.getText,setText=_ref.setText;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),visible=_React$useState2[0],setVisible=_React$useState2[1];var _React$useState3=React.useState(null),_React$useState4=_slicedToArray(_React$useState3,2),event=_React$useState4[0],setEvent=_React$useState4[1];var root=React.useRef(null);React.useEffect(function(){var _handleContextMenu=function _handleContextMenu(event){event.preventDefault();setVisible(true);setEvent(event);};var _handleClick=function _handleClick(event){if(event&&event.button===0){var wasOutside=!(event.target.contains===root.current);if(wasOutside)setVisible(false);}};var parent=document.getElementById(parentId);parent.addEventListener('contextmenu',_handleContextMenu);document.addEventListener('click',_handleClick);return function(){parent.removeEventListener('contextmenu',_handleContextMenu);document.removeEventListener('click',_handleClick);};},[parentId]);React.useEffect(function(){if(!event)return;var clickX=event.clientX;var clickY=event.clientY;var screenW=window.innerWidth;var screenH=window.innerHeight;var rootW=root.current.offsetWidth;var rootH=root.current.offsetHeight;var right=screenW-clickX>rootW;var left=!right;var top=screenH-clickY>rootH;var bottom=!top;if(right){root.current.style.left=\"\".concat(clickX+5,\"px\");}if(left){root.current.style.left=\"\".concat(clickX-rootW-5,\"px\");}if(top){root.current.style.top=\"\".concat(clickY+5,\"px\");}if(bottom){root.current.style.top=\"\".concat(clickY-rootH-5,\"px\");}},[event]);return visible&&/*#__PURE__*/_jsxs(\"div\",{ref:root,className:\"contextMenu\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"contextMenuOption\",onClick:getText,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"contextMenuName\",children:[\" \",_(\"Copy\"),\" \"]}),/*#__PURE__*/_jsx(\"div\",{className:\"contextMenuShortcut\",children:_(\"Ctrl+Insert\")})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"contextMenuOption\",onClick:setText,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"contextMenuName\",children:[\" \",_(\"Paste\"),\" \"]}),/*#__PURE__*/_jsx(\"div\",{className:\"contextMenuShortcut\",children:_(\"Shift+Insert\")})]})]});};","map":{"version":3,"names":["cockpit","React","jsxs","_jsxs","jsx","_jsx","_","gettext","ContextMenu","_ref","parentId","getText","setText","_React$useState","useState","_React$useState2","_slicedToArray","visible","setVisible","_React$useState3","_React$useState4","event","setEvent","root","useRef","useEffect","_handleContextMenu","preventDefault","_handleClick","button","wasOutside","target","contains","current","parent","document","getElementById","addEventListener","removeEventListener","clickX","clientX","clickY","clientY","screenW","window","innerWidth","screenH","innerHeight","rootW","offsetWidth","rootH","offsetHeight","right","left","top","bottom","style","concat","ref","className","children","onClick"],"sources":["/data/stackhub-web/plugins/myapps/src/lib/cockpit-components-context-menu.js"],"sourcesContent":["import cockpit from \"cockpit\";\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\nimport \"../assets/scss/custom/terminal/context-menu.css\";\n\nconst _ = cockpit.gettext;\n\nexport const ContextMenu = ({ parentId, getText, setText }) => {\n    const [visible, setVisible] = React.useState(false);\n    const [event, setEvent] = React.useState(null);\n    const root = React.useRef(null);\n\n    React.useEffect(() => {\n        const _handleContextMenu = (event) => {\n            event.preventDefault();\n\n            setVisible(true);\n            setEvent(event);\n        };\n\n        const _handleClick = (event) => {\n            if (event && event.button === 0) {\n                const wasOutside = !(event.target.contains === root.current);\n\n                if (wasOutside)\n                    setVisible(false);\n            }\n        };\n\n        const parent = document.getElementById(parentId);\n        parent.addEventListener('contextmenu', _handleContextMenu);\n        document.addEventListener('click', _handleClick);\n\n        return () => {\n            parent.removeEventListener('contextmenu', _handleContextMenu);\n            document.removeEventListener('click', _handleClick);\n        };\n    }, [parentId]);\n\n    React.useEffect(() => {\n        if (!event)\n            return;\n\n        const clickX = event.clientX;\n        const clickY = event.clientY;\n        const screenW = window.innerWidth;\n        const screenH = window.innerHeight;\n        const rootW = root.current.offsetWidth;\n        const rootH = root.current.offsetHeight;\n\n        const right = (screenW - clickX) > rootW;\n        const left = !right;\n        const top = (screenH - clickY) > rootH;\n        const bottom = !top;\n\n        if (right) {\n            root.current.style.left = `${clickX + 5}px`;\n        }\n\n        if (left) {\n            root.current.style.left = `${clickX - rootW - 5}px`;\n        }\n\n        if (top) {\n            root.current.style.top = `${clickY + 5}px`;\n        }\n\n        if (bottom) {\n            root.current.style.top = `${clickY - rootH - 5}px`;\n        }\n    }, [event]);\n\n    return visible &&\n        <div ref={root} className=\"contextMenu\">\n            <button className=\"contextMenuOption\" onClick={getText}>\n                <div className=\"contextMenuName\"> {_(\"Copy\")} </div>\n                <div className=\"contextMenuShortcut\">{_(\"Ctrl+Insert\")}</div>\n            </button>\n            <button className=\"contextMenuOption\" onClick={setText}>\n                <div className=\"contextMenuName\"> {_(\"Paste\")} </div>\n                <div className=\"contextMenuShortcut\">{_(\"Shift+Insert\")}</div>\n            </button>\n        </div>;\n};\n\nContextMenu.propTypes = {\n    getText: PropTypes.func.isRequired,\n    setText: PropTypes.func.isRequired,\n    parentId: PropTypes.string.isRequired\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}